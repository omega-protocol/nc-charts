{{- if .Values.manifests.service }}
---
apiVersion: v1
kind: Service
metadata:
  name: tekton-dashboard
spec:
  selector:
    release_group: {{ $.Values.release_group | default $.Release.Name }}
    application: "tekton-dashboard"
    component: "server"
  {{- if $.Values.network.node_port.enabled }}
  type: NodePort
  {{- if $.Values.network.external_policy_local }}
  externalTrafficPolicy: Local
  {{- end }}
  {{- end }}
  ports:
  - name: web
    protocol: TCP
    port: {{ tuple "tekton-dashboard" "internal" "web" $ | include "tekton.port_lookup" }}
    targetPort:  {{ tuple "tekton-dashboard" "internal" "web" $ | include "tekton.port_lookup" }}
    {{- if $.Values.network.node_port.enabled }}
    nodePort: {{ $.Values.network.node_port.port }}
    {{- end }}
{{- end }}
